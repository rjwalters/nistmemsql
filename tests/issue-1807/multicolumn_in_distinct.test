# Issue #1807: Multi-column IN clause with DISTINCT
#
# This test forces the materialized execution path (execute_without_aggregation)
# where the index optimization is applied. DISTINCT requires materializing
# all rows before eliminating duplicates.
#
# CRITICAL: This test demonstrates that the fix works in the materialized
# path but requires disabling predicate pushdown, which is a performance
# regression for ALL queries.

statement ok
CREATE TABLE test(pk INTEGER PRIMARY KEY, a INTEGER, b INTEGER)

statement ok
CREATE INDEX idx_test ON test (a, b)

statement ok
INSERT INTO test VALUES (1, 10, 20)

statement ok
INSERT INTO test VALUES (2, 10, 30)

statement ok
INSERT INTO test VALUES (3, 20, 40)

# Test with DISTINCT to force materialized execution
# EXPECTED: Should return rows 1 and 2
# WITHOUT FIX: Returns 0 rows
query I rowsort
SELECT DISTINCT pk FROM test WHERE a IN (10)
----
1
2

# DISTINCT with multiple values
query I rowsort
SELECT DISTINCT pk FROM test WHERE a IN (10, 20)
----
1
2
3

# DISTINCT on the indexed column itself
query I rowsort
SELECT DISTINCT a FROM test WHERE a IN (10)
----
10
