# Issue #1807: Edge Cases for Multi-column IN Optimization
#
# This test file documents edge cases and corner scenarios that must
# be handled correctly by the multi-column IN clause optimization.

statement ok
CREATE TABLE test(pk INTEGER PRIMARY KEY, a INTEGER, b INTEGER)

statement ok
CREATE INDEX idx_test ON test (a, b)

statement ok
INSERT INTO test VALUES (1, 10, 20)

statement ok
INSERT INTO test VALUES (2, 10, 30)

statement ok
INSERT INTO test VALUES (3, 20, 40)

statement ok
INSERT INTO test VALUES (4, NULL, 50)

statement ok
INSERT INTO test VALUES (5, 30, NULL)

# Edge Case 1: NULL values in indexed column
# EXPECTED: NULL is not equal to any value, so IN clause excludes it
query I rowsort
SELECT pk FROM test WHERE a IN (10, 20, 30)
----
1
2
3
5

# Edge Case 2: Empty IN clause (should fail at parse time)
# statement error
# SELECT pk FROM test WHERE a IN ()

# Edge Case 3: IN clause with duplicate values
# EXPECTED: Duplicates should not affect results
query I rowsort
SELECT pk FROM test WHERE a IN (10, 10, 20)
----
1
2
3

# Edge Case 4: IN clause with NULL in the value list
# EXPECTED: NULL in IN list is ignored (NULL != NULL)
query I rowsort
SELECT pk FROM test WHERE a IN (10, NULL)
----
1
2

# Edge Case 5: Large IN clause (stress test)
# EXPECTED: Should handle many values efficiently
query I rowsort
SELECT pk FROM test WHERE a IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
----
1
2
3

# Edge Case 6: IN clause with all NULLs
# EXPECTED: No rows returned
query I rowsort
SELECT pk FROM test WHERE a IN (NULL, NULL)
----

# Edge Case 7: Combining NULL check with IN
# EXPECTED: Returns rows with a IN (10) OR a IS NULL
query I rowsort
SELECT pk FROM test WHERE a IN (10) OR a IS NULL
----
1
2
4
