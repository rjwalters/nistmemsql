# Test GROUP BY with NULL values
# Issue: #1878
# Tests that NULL values correctly group together in GROUP BY

statement ok
CREATE TABLE sales (region TEXT, amount INTEGER);

statement ok
INSERT INTO sales VALUES ('North', 100);

statement ok
INSERT INTO sales VALUES ('North', 200);

statement ok
INSERT INTO sales VALUES ('South', 150);

statement ok
INSERT INTO sales VALUES (NULL, 50);

statement ok
INSERT INTO sales VALUES (NULL, 75);

# Test 1: GROUP BY with NULL - NULL values should form one group
query TI rowsort
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region;
----
NULL	125
North	300
South	150

# Test 2: GROUP BY with COUNT - verify NULL grouping
query TI rowsort
SELECT region, COUNT(*) as cnt
FROM sales
GROUP BY region;
----
NULL	2
North	2
South	1

# Test 3: GROUP BY with multiple aggregates
query TIII rowsort
SELECT region, SUM(amount), MIN(amount), MAX(amount)
FROM sales
GROUP BY region;
----
NULL	125	50	75
North	300	100	200
South	150	150	150
